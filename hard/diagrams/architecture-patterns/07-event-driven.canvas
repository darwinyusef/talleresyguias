{
	"nodes":[
		{"id":"title","type":"text","text":"# Event-Driven Architecture\n\n**PropÃ³sito:** Producir, detectar, consumir y reaccionar a eventos\n\n**CuÃ¡ndo usar:**\nâœ… Sistemas desacoplados\nâœ… Real-time processing\nâœ… Microservices communication\nâœ… Complex workflows\n\nâŒ **NO** para flujos sÃ­ncronos simples\nâŒ **NO** cuando orden estricto es crÃ­tico\n\n[[28_EVENT_DRIVEN_ASYNC_MESSAGING]]","x":-1000,"y":-500,"width":500,"height":450,"color":"6"},
		{"id":"producer-1","type":"text","text":"## ğŸ“¤ PRODUCER\n**User Service**\n\n```python\nclass UserService:\n    def create_user(self, dto):\n        user = User.create(dto)\n        self.repo.save(user)\n        \n        # Publish event\n        self.event_bus.publish(\n            event=UserCreated(\n                id=user.id,\n                email=user.email,\n                timestamp=now()\n            ),\n            topic='user.events'\n        )\n```\n\n**Fire & Forget**","x":-600,"y":-200,"width":450,"height":450,"color":"1"},
		{"id":"producer-2","type":"text","text":"## ğŸ“¤ PRODUCER\n**Order Service**\n\n```python\nclass OrderService:\n    def complete_order(\n        self, order_id\n    ):\n        order = self.repo.get(\n            order_id\n        )\n        order.mark_completed()\n        \n        self.event_bus.publish(\n            OrderCompleted(\n                order_id=order.id,\n                user_id=order.user_id,\n                total=order.total\n            ),\n            'order.events'\n        )\n```","x":-600,"y":350,"width":450,"height":450,"color":"1"},
		{"id":"event-bus","type":"text","text":"## ğŸšŒ EVENT BUS\n**Message Broker**\n\n```\nKafka / RabbitMQ / AWS SNS+SQS\n\nTopics:\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”\nâ”‚ user.events     â”‚\nâ”‚ order.events    â”‚\nâ”‚ payment.events  â”‚\nâ”‚ notification.*  â”‚\nâ””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜\n```\n\n**CaracterÃ­sticas:**\n- Durability (persistencia)\n- Ordering (por partition)\n- Replay (Kafka)\n- At-least-once delivery\n\n**Desacoplamiento espacio-temporal**","x":0,"y":0,"width":450,"height":550,"color":"5"},
		{"id":"consumer-email","type":"text","text":"## ğŸ“¥ CONSUMER\n**Email Service**\n\n```python\nclass EmailService:\n    @subscribe('user.events')\n    def on_event(self, event):\n        if isinstance(\n            event, \n            UserCreated\n        ):\n            self.send_welcome_email(\n                event.email\n            )\n```\n\n**Pull model**\n**Idempotent**","x":600,"y":-300,"width":380,"height":350,"color":"4"},
		{"id":"consumer-analytics","type":"text","text":"## ğŸ“¥ CONSUMER\n**Analytics Service**\n\n```python\nclass AnalyticsService:\n    @subscribe([\n        'user.events',\n        'order.events'\n    ])\n    def on_event(self, event):\n        self.warehouse.insert(\n            event_type=type(event),\n            data=event.to_dict(),\n            timestamp=event.ts\n        )\n```\n\n**Multiple topics**","x":600,"y":100,"width":380,"height":400,"color":"4"},
		{"id":"consumer-notification","type":"text","text":"## ğŸ“¥ CONSUMER\n**Notification Service**\n\n```python\nclass NotificationService:\n    @subscribe('order.events')\n    def on_order_completed(\n        self, event\n    ):\n        if isinstance(\n            event,\n            OrderCompleted\n        ):\n            self.push.send(\n                user_id=event.user_id,\n                message=\"Order ready!\"\n            )\n```","x":600,"y":550,"width":380,"height":400,"color":"4"},
		{"id":"patterns","type":"text","text":"## ğŸ¨ Patterns\n\n**1. Pub/Sub**\n- 1 producer â†’ N consumers\n- Fan-out\n\n**2. Event Streaming**\n- Kafka log\n- Replay capability\n\n**3. Event Sourcing**\n- Events = source of truth\n\n**4. CQRS**\n- Commands â†’ Events â†’ Queries\n\n**5. Saga**\n- Distributed transactions\n- Choreography","x":1050,"y":-300,"width":400,"height":500,"color":"6"},
		{"id":"benefits","type":"text","text":"## âœ… Beneficios\n\n1. **Desacoplamiento**\n   - Producers â‰  Consumers\n   - Agregar consumers sin cambiar producers\n   \n2. **Escalabilidad**\n   - Scale independently\n   - Asynchronous processing\n   \n3. **Resilience**\n   - Retry automÃ¡tico\n   - Dead letter queues\n   \n4. **Auditing**\n   - Event log completo\n   \n5. **Flexibility**\n   - Nuevos consumers sin deploy","x":1050,"y":250,"width":400,"height":500,"color":"6"},
		{"id":"challenges","type":"text","text":"## âš ï¸ DesafÃ­os\n\n1. **Eventual Consistency**\n   - No immediate consistency\n   \n2. **Debugging**\n   - Distributed tracing needed\n   - Correlation IDs\n   \n3. **Ordering**\n   - GarantÃ­as limitadas\n   - Partition keys\n   \n4. **Duplicate Events**\n   - At-least-once delivery\n   - Idempotency required\n   \n5. **Schema Evolution**\n   - Event versioning\n   - Backward compatibility","x":-1000,"y":50,"width":450,"height":500,"color":"2"}
	],
	"edges":[
		{"id":"edge-p1-bus","fromNode":"producer-1","toNode":"event-bus","label":"Publish â†’","fromSide":"right","toSide":"left"},
		{"id":"edge-p2-bus","fromNode":"producer-2","toNode":"event-bus","label":"Publish â†’","fromSide":"right","toSide":"left"},
		{"id":"edge-bus-email","fromNode":"event-bus","toNode":"consumer-email","label":"Subscribe","fromSide":"right","toSide":"left"},
		{"id":"edge-bus-analytics","fromNode":"event-bus","toNode":"consumer-analytics","label":"Subscribe","fromSide":"right","toSide":"left"},
		{"id":"edge-bus-notification","fromNode":"event-bus","toNode":"consumer-notification","label":"Subscribe","fromSide":"right","toSide":"left"}
	]
}